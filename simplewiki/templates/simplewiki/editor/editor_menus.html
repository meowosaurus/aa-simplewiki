{% extends 'simplewiki/base.html' %}
{% load i18n %}
{% load humanize %}
{% load static %}
{% load custom_filters %}

{% block details %}
{% if user_action == 'none' %}
    <div class="d-flex flex-row-reverse bd-highlight" style="margin-bottom: 1rem;">
      <form method="GET" action="{% url 'simplewiki:editor_menus' %}">
        <button type="submit" name="create" value="1" class="btn btn-success btn-sm">
          <i class="fas fa-plus-square"></i>
          Create new menu
        </button>
      </form>
    </div>
              
    {% endif %}
    <div class="card card-primary">
        <div class="card-header">
            <div class="card-title">
              <div class="text-center">
                {% translate "Menu Administration" %}
              </div>
            </div>
        </div>

        {% if user_action == 'none' %}
          {% include 'simplewiki/editor/partials/menus/_list_menus.html' %}
        {% elif user_action == 'edit' %}
          {% include 'simplewiki/editor/partials/menus/_edit_menu.html' %}
        {% elif user_action == 'delete' %}
          {% include 'simplewiki/editor/partials/menus/_delete_menu.html' %}
        {% elif user_action == 'create' %}
          {% include 'simplewiki/editor/partials/menus/_create_menu.html' %}
        {% endif %}
    </div>
{% endblock %}

{% block extra_javascript %}
{% if user_action == 'edit' %}
{# groupInput needs to be seperated, otherwise it won't find the input #}
{% if False %}
<script>
  const selectElement = document.getElementById("menuParentSelect");
  const selectedPath = "{{ selectedMenu.parent.path }}";

  for (let i = 0; i < menuParentSelect.options.length; i++) {
          if (menuParentSelect.options[i].value == selectedPath) {
              menuParentSelect.options[i].selected = true;
              break;
          }
      }

  document.addEventListener('DOMContentLoaded', function() {
      const menuParentSelect = document.getElementById('menuParentSelect');
      const selectedPath = "{{ selectedMenu.parent.path }}";

      for (let i = 0; i < menuParentSelect.options.length; i++) {
          if (menuParentSelect.options[i].value == selectedPath) {
              menuParentSelect.options[i].selected = true;
              break;
          }
      }
  });
</script>
{% endif %}
<script>
  document.getElementById("titleInput").value = '{{ selectedMenu.title|escapejs }}';
  document.getElementById("iconInput").value = '{{ selectedMenu.icon|escapejs }}';
</script>

{% endif %}
{% endblock %}

{% block extra_script %}
{% endblock %}
